\chapter{Numerische Tests}
\label{cha:NumerischeTests}

In diesem Kapitel möchten wir die vorgestellten Verfahren verschiedenen numerischen Tests unterziehen. Dabei wollen wir hauptsächlich den Fehler der numerischen Lösung zur analytischen untersuchen, aber auch die Kondition der Kollokationsmatrizen, die Parameterwahl und die Laufzeit betrachten. Zusätzlich werden wir die Verfahren mit der finiten Elemente Methode (\acs{FEM}) vergleichen.

Dafür betrachten wir die Poisson-Gleichung mit Dirichlet-Randbedingung auf $\Omega = [-1,1] \times [-1,1] \subset \mathbb{R}^n$:
\begin{align*}
- \Delta u &= 2\pi^2 \sin(\pi x)\sin(\pi y)&&, (x,y) \in \Omega\\
u &= 0&&, (x,y) \in \partial \Omega
\end{align*}
mit analytischer Lösung $u(x,y) = \sin(\pi x)\sin(\pi y)$, dargestellt in Abbildung \ref{fig:plot}. Wir wählen als Gewichtsfunktion $w$ für $\Omega$ die Funktion aus Beispiel \ref{ex:Gewicht}:
\begin{align*}
w = -x^2-y^2+2 - \sqrt{x^4 -2x^2 + y^4 -2y^2+2}.
\end{align*}
\begin{figure}[h]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/plot.tex}
}
\caption{Lösung der \ac{PDE}}
\label{fig:plot}
\end{figure}

Diese werden wir mithilfe der Kernkollokation numerisch lösen. Dafür wählen wir den Gauß Kern aus Beispiel \ref{ex:Kern}.

\section{Fehler}
\subsection{Absoluter Fehler}

Als Maß des Fehlers unserer numerischen Lösung wollen wir zunächst den maximalen absoluten Fehler zur analytischen Lösung berechnen, also
\begin{align*}
\text{error} = \max_{x \in \Omega} |u(x) - s_u (x)|,
\end{align*}
wobei $s_u$ die numerische Lösung bezeichnet.
Wir werden die Kollokationspunkte, so wie die Testpunkte, zunächst, wie in Abbildung \ref{fig:Kollok} gezeigt, in einem Gitter anordnen.
\begin{figure}[h]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/Kollokationspunkte.tex}
}
\caption{Kollokationspunkte}
\label{fig:Kollok}
\end{figure}

Damit können wir uns anschauen, wie sich der Fehler bei Veränderung der Anzahl der Kollokationspunkte verhält. In Abbildung \ref{fig:error} und Tabelle \ref{tab:Vergleich Fehler} ist der Fehler der vier verschiedenen Verfahren dargestellt. 
\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/error-grid.tex}
}
\caption{Fehler bei Kollokationspunkten auf Gitter}
\label{fig:error}
\end{figure}
\begin{table}[H]
\centering
\begin{tabular}{c|c|c|c|c}
%\hline 
 & $n = 9$ & $n = 100$ & $n = 1024$ & $n = 6084$ \\ 
\hline 
Standard N-Sym & \num{0.99974} & \num{2.18205e-04} & \num{2.61592e-06} & \num{9.07630e-06} \\ 
%\hline 
Standard Sym & \num{0.99974} & \num{2.48216e-05} & \num{1.08639e-07} & \num{1.31851e-07} \\ 
%\hline 
Gewichtet N-Sym & \num{0.37643} & \num{8.20819e-03} & \num{1.87889e-03} & \num{3.09914e-04} \\ 
%\hline 
Gewichtet Sym & \num{0.27994} & \num{6.40403e-03} & \num{1.04064e-03} & • \\ 
%\hline 
\end{tabular} 
\caption{Vergleich der Verfahren}
\label{tab:Vergleich Fehler}
\end{table}

Wir stellen als erstes fest, dass alle Verfahren vernünftige Ergebnisse liefern und konvergieren. Unsere theoretische Herleitung war demnach also sinnvoll. 

Wir erkennen, dass alle Verfahren sehr schnell gute Ergebnisse liefern. Die beiden Standardverfahren liefern bereits mit nahezu $100$ Kollokationspunkten ihre besten Ergebnisse und verbessern sich danach nur noch wenig. Im Gegensatz dazu stehen die gewichteten Verfahren, die zwar auch schon am Anfang gute Ergebnisse liefern, sich dann aber auch mit mehr Kollokationspunkten weiter verbessern, wenn auch ziemlich langsam. Gesamt erreichen die gewichteten Verfahren aber selbst mit $6000$ Kollokationspunkten nicht die Genauigkeit der Standardverfahren. Im Vergleich der symmetrischen und nicht-symmetrischen Verfahren schneiden beide Male die symmetrischen Verfahren leicht besser ab.

Als nächstes schauen wir uns zufällig verteilte Kollokationspunkte an. In Abbildung \ref{fig:error-random} ist der Fehler bei unterschiedlich vielen zufällig verteilten Kollokationspunkten dargestellt.
\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/error-random.tex}
}
\caption{Fehler bei zufällig verteilten Kollokationspunkten}
\label{fig:error-random}
\end{figure}

Vergleicht man die Werte mit denen der auf einem Gitter verteilten Kollokationspunkte, stellt man keinen großen Unterschied fest. Die Größenordnung der Fehler ist in beiden Fällen gleich, allerdings weisen die zufälligen Punkte, vor allem bei den gewichteten Verfahren, größere Schwankungen auf. Demnach ist hinsichtlich des Fehlers kein Vorteil für die zufällig gewählten Punkte erkennbar.

\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/error-greedy.tex}
}
\caption{Fehler bei zufällig verteilten Kollokationspunkten}
\label{fig:error-random}
\end{figure}
\subsection{Fehler auf dem Rand}

Wir möchten nun überprüfen, ob die gewichtete Kollokation ihren Sinn erfüllt, d.h. ob die Lösung auf dem Rand auch wirklich Null ist. Dafür plotten wir eine mit dem Standardverfahren erstellte Lösung und eine mit dem gewichteten Verfahren erstellte Lösung in Abbildung \ref{fig:rand-vergleich} über einen Teil des Randes.

\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/Rand-vergleich.tex}
}
\caption{Rand bei gewichteter Kollokation}
\label{fig:rand-vergleich}
\end{figure}

Bei der Standardkollokation sind deutlich Schwankungen über den Rand erkennbar, wohingegen der Rand bei der gewichteten Kollokation bis auf kleine numerische Ungenauigkeiten tatsächlich Null ist. Das Ziel der gewichteten Kollokation wurde also erreicht.

\subsection{Testpunkte}

Wir sind bisher nur auf die Wahl der Kollokationspunkte eingegangen, aber noch nicht auf die der Testpunkte. Dafür stellen wir den Fehler unserer numerischen Lösung in Abbildung \ref{fig:testpunkte} bei gleichbleibenden Kollokationspunkten, aber bei unterschiedlichen Anzahlen von Testpunkten dar. Diese sind auch hier wieder in einem Gitter angeordnet.
\begin{figure}[H]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/Testpunkte.tex}
}
\caption{Fehler bei unterschiedlicher Anzahl an Testpunkten}
\label{fig:testpunkte}
\end{figure}
Wir erkennen, dass der Fehler bis auf wenige Ausreißer konstant bleibt. Damit ist die Wahl der Testpunkte beinahe egal. Die großen Fehler entstehen genau dann, wenn alle Testpunkte mit den Kollokationspunkten zusammenfallen. Den hier auftretenden Effekt nennt man Überanpassung. Die Lösung wird dabei zu gut an die Testdaten angepasst und verliert dabei an Genauigkeit, wenn man das ganze Gebiet $\Omega$ betrachtet. 

In Abbildung \ref{fig:testpunkte-gamma} ist der gewählte Parameter gamma bei unterschiedlichen Testpunktanzahlen dargestellt.
\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/Testpunkte-gamma.tex}
}
\caption{Gammawerte bei unterschiedlicher Anzahl an Testpunkten}
\label{fig:testpunkte-gamma}
\end{figure}
Dabei stellt man fest, dass genau dann, wenn ein großer Fehler auftritt auch ein großes gamma gewählt wird. Wir erinnern uns an Abbildung \ref{fig:Kerne}, dass ein großes gamma einem schmalen "Hütchen"  der Kernfunktion entspricht. Das kann man so interpretieren, dass, wenn Test- und Kollokationspunkte zusammenfallen, die Ansatzfunktionen so gewählt werden, dass sie, wenn möglich, nur Einfluss auf einen Testpunkt, nämlich den, an dem sie angesetzt werden, nehmen. Erkennbar ist dies in Abbildung \ref{fig:overfitting}.
\begin{figure}[ht]
\centering
\resizebox {\columnwidth} {!} {
\input{plots/overfitting.pdf_tex}
}
\caption{Gammawerte bei unterschiedlicher Anzahl an Testpunkten}
\label{fig:overfitting}
\end{figure}

So entsteht eine Lösung, die an den Testpunkten extrem gut angepasst ist, ansonsten der echten Lösung aber kaum ähnlich sieht.
%\section{Kondition}
%\section{Laufzeit}