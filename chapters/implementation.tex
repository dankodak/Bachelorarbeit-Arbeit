\chapter{Implementierung}
\label{cha:Implementierung}

In diesem Kapitel möchten wir uns die Implementierung der bisher theoretisch hergeleiteten Verfahren anschauen.

Dazu müssen wir zunächst einen geeigneten Kern wählen. Wir erinnern uns an Beispiel \ref{ex:Kern}, dass die Kerne einen Parameter $\gamma$ besitzen. In Abbildung \ref{fig:Kerne} ist der Gauß Kern $K(x,y) = \exp\left(-\gamma \|x-y\|^2\right)$ mit $y= 0$ und verschiedenen $\gamma$ Werten geplottet. So können wir zur Parameterwahl eine ganze Familie an Kernen wählen, über die wir leicht iterieren können.
\begin{figure}[ht]
\centering
\resizebox {.8\columnwidth} {!} {
\input{plots/KernVergleich.tex}
}
\caption{Plots verschiedener Kerne}
\label{fig:Kerne}
\end{figure}

So erhält man nach Wahl von Kollokationspunkten $X$ und Testpunkten $Xte$ den Algorithmus \ref{alg:Grund}.
\input{code/grundlegend.tex}

Einige Anmerkungen zu dem Algorithmus:
\begin{itemize}
\item
Kollokationspunkte sind die Punkte, die wir bereits aus der theoretischen Herleitung kennen. Also die Punkte, an denen wir die Interpolation durchführen.\\
Testpunkte sind die Punkte, an denen wir den Fehler unserer Lösung bestimmen.
\item
$f$ und $g$ bezeichnen die rechte Seite der zu lösenden \gls{PDE}.
\item
Der Algorithmus funktioniert so für die Standard und für die gewichtete Kollokation. Angepasst werden müssen nur die Unterfunktionen zum Aufstellen der rechten Seite und der Kollokationsmatrix.
\end{itemize}
Es ist noch offen wie wir die Kollokations- und Testpunkte und den Fehler in jeder Iteration bestimmen. Zuerst betrachten wir Letzteres. Dafür möchten wir zwei Möglichkeiten vorstellen:
\begin{itemize}
\item
Falls wir eine analytisch bestimmte Lösung der \gls{PDE} haben sollten, können wir diese mit der approximierten vergleichen. Sei dazu $u$ die analytische Lösung und $s_u$ die approximierte. Den Fehler erhalten wir dann mit
\begin{align*}
\mathrm{error} = \max_{x \in Xte} \left(\left| u(x) - s_u(x) \right| \right)
\end{align*}
\item
Eine analytische Lösung werden wir jedoch meist nicht besitzen und können die erste Methode somit nicht anwenden. Wir haben aber noch die Möglichkeit den Fehler in der Ableitung zu betrachten. Sei dafür $L$ der Differentialoperator aus der \gls{PDE}, $f$ die rechte Seite in \gls{PDE} und $s_u$ die approximierte Lösung. Den Fehler erhalten wir dann mit
\begin{align*}
\mathrm{error} = \max_{x \in Xte} \left(\left| f(x) - L s_u(x) \right| \right)
\end{align*}
$Ls_u$ lässt sich aufgrund der Linearität des Differentialoperators leicht berechnen. So kann man ausnutzen, dass $s_u$ eine Linearkombination aus den einzelnen Basisfunktionen ist, und $L$ auf die einzelnen Summanden anwenden.
\end{itemize}

Kommen wir zur Bestimmung der Kollokationspunkte. Auch hier möchten wir mehrere Möglichkeiten vorstellen.
\begin{itemize}
\item
Die Kollokationspunkte können als Gitter über das Definitionsgebiet gelegt werden.
\item
Die Kollokationspunkte können zufällig gewählt werden.
\item
Eine Greedy-Punktwahl ist auch möglich. Dafür berechnet man zunächst eine Lösung aus den aktuell gegebenen Punkten. Auf diese Lösung kann man dann den Differentialoperator aus der \ac{PDE} anwenden. Zwischen dieser Funktion und der rechten Seite der \ac{PDE} kann man dann den maximalen Fehler in dem Definitionsgebiet bestimmen. An die Stelle, an der der maximale Fehler angenommen wird, wird der neue Kollokationspunkt gesetzt. Dieses Verfahren kann dann wiederholt werden.
\end{itemize}

Die Testpunkte können, wie die Kollokationspunkte, zufällig gewählt werden, oder in einem Gitter über das Definitionsgebiet gelegt werden.